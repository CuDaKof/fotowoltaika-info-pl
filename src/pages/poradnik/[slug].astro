---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { ARTYKULY } from "../../data/artykuly";

export function getStaticPaths() {
  return ARTYKULY.map(art => ({ 
    params: { slug: art.slug }, 
    props: { artykul: art } 
  }));
}

const { artykul } = Astro.props;
---
<BaseLayout title={artykul.tytul} description={artykul.lead}>
  <!-- Article Header -->
  <article class="max-w-4xl mx-auto px-4 py-12">
    <div class="mb-8">
      <div class="text-sm text-blue-600 font-semibold uppercase mb-3">{artykul.kategoria}</div>
      <h1 class="text-4xl md:text-5xl font-bold mb-4">{artykul.tytul}</h1>
      <p class="text-xl text-gray-600 mb-6">{artykul.lead}</p>
      <div class="flex items-center gap-4 text-sm text-gray-500">
        <span>ğŸ“… {artykul.data}</span>
        <span>âœï¸ {artykul.autor}</span>
      </div>
    </div>

    <!-- Article Content -->
    <div class="prose prose-lg max-w-none">
      <!-- WstÄ™p -->
      <div class="text-lg text-gray-700 leading-relaxed mb-8">
        {artykul.tresc.wstep.split('\n\n').map(para => (
          <p class="mb-4">{para}</p>
        ))}
      </div>

      <!-- Sekcje -->
      {artykul.tresc.sekcje.map((sekcja, idx) => (
        <section class="mb-12">
          <h2 class="text-2xl md:text-3xl font-bold mb-4 text-gray-900">{sekcja.naglowek}</h2>
          <div class="text-gray-700 leading-relaxed">
            {sekcja.tresc.split('\n\n').map(para => (
              <p class="mb-4" set:html={para.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').replace(/\n/g, '<br/>')}></p>
            ))}
          </div>
          {sekcja.lista && (
            <ul class="list-disc pl-6 space-y-2 mt-4 text-gray-700">
              {sekcja.lista.map(item => (
                <li>{item}</li>
              ))}
            </ul>
          )}
        </section>
      ))}

      <!-- Podsumowanie -->
      <div class="bg-blue-50 border-l-4 border-blue-600 p-6 my-8">
        <h3 class="text-xl font-bold mb-3">ğŸ“Œ Podsumowanie</h3>
        <p class="text-gray-700 leading-relaxed">{artykul.tresc.podsumowanie}</p>
      </div>
    </div>

    <!-- FAQ (jeÅ›li istnieje) -->
    {artykul.faq && (
      <div class="mt-12">
        <h2 class="text-2xl font-bold mb-6">NajczÄ™stsze pytania</h2>
        <div class="space-y-4">
          {artykul.faq.map(item => (
            <details class="bg-white border rounded-lg p-5 hover:shadow-md transition">
              <summary class="font-semibold cursor-pointer">{item.pytanie}</summary>
              <div class="mt-3 text-gray-700 text-sm">{item.odpowiedz}</div>
            </details>
          ))}
        </div>
      </div>
    )}

    <!-- CTA -->
    <section class="bg-blue-600 text-white rounded-lg p-8 mt-12 text-center">
      <h2 class="text-2xl md:text-3xl font-bold mb-3">{artykul.cta.tytul}</h2>
      <p class="text-lg mb-6 opacity-90">{artykul.cta.opis}</p>
      <a 
        href={artykul.cta.link} 
        class="inline-block px-8 py-4 bg-white text-blue-600 rounded-lg font-bold hover:bg-gray-100 transition"
      >
        {artykul.cta.tekstPrzycisku}
      </a>
    </section>

    <!-- Related Articles -->
    <div class="mt-16 pt-8 border-t">
      <h3 class="text-xl font-bold mb-6">PowiÄ…zane artykuÅ‚y</h3>
      <div class="grid md:grid-cols-2 gap-6">
        {ARTYKULY
          .filter(a => a.kategoria === artykul.kategoria && a.slug !== artykul.slug)
          .slice(0, 2)
          .map(related => (
            <a 
              href={`/poradnik/${related.slug}`}
              class="block p-6 border rounded-lg hover:shadow-lg transition"
            >
              <div class="text-xs text-blue-600 font-semibold uppercase mb-2">{related.kategoria}</div>
              <h4 class="font-semibold text-lg mb-2">{related.tytul}</h4>
              <p class="text-sm text-gray-600">{related.lead}</p>
            </a>
          ))
        }
      </div>
      <div class="mt-6 text-center">
        <a href="/poradnik" class="text-blue-600 font-medium hover:underline">
          â† WrÃ³Ä‡ do wszystkich artykuÅ‚Ã³w
        </a>
      </div>
    </div>
  </article>
</BaseLayout>
